!function(){"use strict";var MTBADVS=window.MTBADVS=window.MTBADVS||{};MTBADVS.Common=MTBADVS.Common||{},MTBADVS.Common.Config={host:{ad:"ad.mtburn.com",imp:"imp.mtburn.com",click:"click.mtburn.com",conv:"conv.mtburn.com"},protocol:window.location.protocol.match(/https:/i)?"https:":"http:",ad_type:{icon:2,instream:5},version:"1.0.0",conv:{max_request_per_page:10},rtg:{max_request_per_page:4},jsonp_timeout_ms:1e4};var MTBADVS="undefined"==typeof window.MTBADVS?{}:window.MTBADVS;window.MTBADVS=MTBADVS,MTBADVS.Common="undefined"==typeof window.MTBADVS.Common?{}:window.MTBADVS.Common,MTBADVS.Common.Util=function(){var Util={};return Util.forEach=function(a,b,c){if(Array.prototype.forEach)return Array.prototype.forEach.call(a,b,c);if("undefined"==typeof a)throw new TypeError;if("function"!=typeof b)throw new TypeError;for(var d=a.length>>>0,e=0;e<d;e++)e in a&&b.call(c,a[e],e,a)},Util.map=function(a,b,c){if(Array.prototype.map)return Array.prototype.map.call(a,b,c);if("undefined"==typeof a)throw new TypeError;if("function"!=typeof b)throw new TypeError;for(var d=a.length>>>0,e=[],f=0;f<d;f++)f in a&&(e[f]=b.call(c,a[f],f,a));return e},Util.objectSeal=function(a){return Object.seal?Object.seal(a):a},Util.jsonParse=function(json_str){return window.JSON?window.JSON.parse(json_str):eval("("+json_str+")")},Util.waitDomReady=function(a){function b(){try{document.documentElement.doScroll("left")}catch(a){return void setTimeout(b,0)}a()}var c=!1;if("complete"===document.readyState||"loaded"===document.readyState)return void a();if(document.addEventListener)document.addEventListener("DOMContentLoaded",function(){a(),c=!0},!1),window.addEventListener("load",function(){c||a()},!1);else if(window.attachEvent)window.ActiveXObject&&window===window.top?b():window.attachEvent("onload",a);else{var d=window.onload;window.onload=function(){"function"==typeof d&&d(),a()}}},Util.extend=function(a,b){for(var c in b)a[c]=b[c];return a},Util.inherits=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.baseConstructor=b},Util.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},Util.isFunction=function(a){return"[object Function]"===Object.prototype.toString.call(a)},Util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},Util}();var MTBADVS=window.MTBADVS=window.MTBADVS||{};MTBADVS.Common=MTBADVS.Common||{},MTBADVS.Common.NetworkBase=function(){var a={};return a.makeCacheBuster=function(){return Math.floor(1e13*Math.random())},a.sendBeaconRequest=function(a){(new Image).src=a},a.callJsonAPI=function(b,c,d){a._supportXHR2()?a.sendAjaxRequest(b,c):a.sendJSONPRequest(b,c,d)},a.sendAjaxRequest=function(b,c){var d=a._createRequestInstance();d.onload=function(){var a;try{a=MTBADVS.Common.Util.jsonParse(d.responseText)}catch(a){return void c(a)}c(null,a)},d.onerror=function(){c(new Error("Network error"))},d.ontimeout=function(){c(new Error("Network timeout"))},d.onprogress=function(){},d.open("GET",b),d.withCredentials=!0,d.send()},a.sendJSONPRequest=function(b,c,d){var e="advs-jsonp-"+d;if(!document.getElementById(e)){var f,g=a._buildJSONPCallbackName(d),h=b+"&callback="+encodeURIComponent("MTBADVS."+g),i=a._buildScriptElement(h,e),j=MTBADVS.Common.Config.jsonp_timeout_ms;f=setTimeout(function(){MTBADVS[g]=function(){},c(new Error("Ad request timeout"))},j),MTBADVS[g]=a._buildJSONPCallback(f,i,g,c),a._appendScriptElement(i)}},a._supportXHR2=function(){var a=navigator.userAgent.toLowerCase(),b=/(msie) ([\w.]+)/.exec(a)||[],c=parseInt(b[2]||99,10);return!(c<=7)&&!(!window.XDomainRequest&&!window.XMLHttpRequest)},a._createRequestInstance=function(){return window.XDomainRequest?new XDomainRequest:new XMLHttpRequest},a._buildJSONPCallbackName=function(a){return"AdJSONPCallback_"+a},a._buildScriptElement=function(a,b){var c=document.createElement("script");return c.src=a,c.id=b,c.type="text/javascript",c.async=!0,c.charset="utf-8",c},a._appendScriptElement=function(a){var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)},a._buildJSONPCallback=function(a,b,c,d){return function(e){return clearTimeout(a),b.parentNode.removeChild(b),delete MTBADVS[c],d(null,e)}},a}();var MTBADVS=window.MTBADVS=window.MTBADVS||{};MTBADVS.Common=MTBADVS.Common||{},MTBADVS.Common.NetworkAd=function(){var a={},b=MTBADVS.Common.Util;a=b.extend(a,MTBADVS.Common.NetworkBase),a.fetchAds=function(a,c,d,e){var f=function(a,f){if(a)return void e(a);var g=b.map(f.items,function(a){return new d(a,c)});e(null,g,f)};this.callJsonAPI(a,f,c)},a.notifyImp=function(a,b){var c=this.buildImpRequestUrl(a,b);this.sendBeaconRequest(c)};var c={};return a.callSyncURLs=function(a){if(a.hasOwnProperty("sync_urls")&&0!==a.sync_urls.length&&a.hasOwnProperty("sync_aid")&&0!==a.sync_aid.length){var b=encodeURIComponent(a.sync_aid),d=this;MTBADVS.Common.Util.forEach(a.sync_urls,function(a){c[a]||(d.sendBeaconRequest(a+b),c[a]=!0)})}},a.buildAdRequestUrl=function(a){var b=MTBADVS.Common.Config,c=b.protocol+"//"+b.host.ad+"/ad?"+a.join("&");return c},a.buildImpRequestUrl=function(a,b){var c=MTBADVS.Common.Config,d=b.toObject(),e=["adspot_id="+encodeURIComponent(a),"dat="+d.dat,"session_id="+d.session_id,"ad_id="+d.ad_id,"cachebuster="+this.makeCacheBuster(),"sdk_version="+c.version],f=c.protocol+"//"+c.host.imp+"/imp?"+e.join("&");return f},a.buildClickRequestUrl=function(a,b){var c=MTBADVS.Common.Config,d=b,e=["adspot_id="+encodeURIComponent(a),"dat="+d.dat,"session_id="+d.session_id,"ad_id="+d.ad_id,"redirect_url="+encodeURIComponent(d.redirect_url),"cachebuster="+this.makeCacheBuster(),"sdk_version="+c.version],f=c.protocol+"//"+c.host.click+"/click?"+e.join("&");return f},a}();var MTBADVS=window.MTBADVS=window.MTBADVS||{};MTBADVS.Common=MTBADVS.Common||{},MTBADVS.Common.AdInfoModelBase=function(){function a(a,b){this.base_info=this.store(a,b)}var b=MTBADVS.Common.Util,c=["advertiser_id","ad_id","title","description","optout","optout_click","dat","conv_type","session_id","url_scheme"];return a.prototype.store=function(a,d){var e={};return b.forEach(c,function(b){e[b]=a[b]}),e.click_url=MTBADVS.Common.NetworkAd.buildClickRequestUrl(d,a),e},a}();var MTBADVS="undefined"==typeof window.MTBADVS?{}:window.MTBADVS;window.MTBADVS=MTBADVS,MTBADVS.InStream="undefined"==typeof window.MTBADVS.InStream?{}:window.MTBADVS.InStream,MTBADVS.InStream.Template=function(){function a(a){this.template_str=a,this.tag_open="{{",this.tag_close="}}"}return a.prototype.render=function(a){var b=this.template_str;for(var c in a)b=b.replace(new RegExp(this.tag_open+c+this.tag_close,"g"),a[c]);return b},a}(),MTBADVS.InStream.Network=function(){var a={},b=MTBADVS.Common.Util;return a=b.extend(a,MTBADVS.Common.NetworkAd),a.fetchInStreamAds=function(a,b,c){var d=this.buildInStreamAdRequestUrl(a,b);this.fetchAds(d,a,MTBADVS.InStream.AdInfoModel,c)},a.buildInStreamAdRequestUrl=function(a,b){var c=MTBADVS.Common.Config,d="";try{d=window==parent?parent.document.URL:document.referrer}catch(a){d=document.referrer}var e=["adspot_id="+encodeURIComponent(a),"ad_type="+c.ad_type.instream,"sequence="+b,"cachebuster="+this.makeCacheBuster(),"sdk_version="+c.version,"media_url="+encodeURIComponent(d)];return this.buildAdRequestUrl(e)},a.notifyTpImp=function(a){var c=a.toObject(),d=c.tp_imp_urls;if(d&&b.isArray(d)&&0!==d.length){var e=this;b.forEach(d,function(a){e.sendBeaconRequest(a)})}},a}(),MTBADVS.InStream.AdInfoModel=function(){function a(b,c){a.baseConstructor.call(this,b,c),this.info=this.storeExtended(b)}var b=["main_image_url","icon_image_url","displayed_advertiser","tp_imp_urls"],c=["title","description","click_url","ad_id","icon_image_url","main_image_url","displayed_advertiser","optout","optout_click"],d=MTBADVS.Common.Util;return d.inherits(a,MTBADVS.Common.AdInfoModelBase),a.prototype.storeExtended=function(a,c){var e=this.base_info;return d.forEach(b,function(b){e[b]=a[b]}),e=d.objectSeal(e)},a.prototype.toObject=function(){return this.info},a.prototype.toObjectWithPublicParams=function(){var a={},b=this;return d.forEach(c,function(c){a[c]=b.info[c]}),a},a}(),MTBADVS.InStream.PlacementInfoModel=function(){function a(a,b){this.info=this.store(a,b)}var b=["adspot_id","template","title_length","description_length","displayed_advertiser_length"],c=MTBADVS.Common.Util;return a.prototype.store=function(a,d){var e={};return c.forEach(b,function(b){e[b]=a[b]}),e.adspot_id=d,e},a.prototype.toObject=function(){return this.info},a}(),MTBADVS.InStream.AdView=function(){function a(a,c,d){this.template=c,this.el=a,this.options=b.isObject(d)?d:{},this.showed=!1}var b=MTBADVS.Common.Util;return a.prototype.show=function(a,c){if(!this.el.parentNode)return void(window.console&&"function"==typeof console.info&&console.info("The ad place not found. Multiple loading tag may have been placed at same page."));b.isFunction(this.options.before_render)&&(a=this.options.before_render(a,c));var d=this.template.render(a),e=this.buildHtmlDomList(d);this.swapTagToAd(e),this.showed=!0},a.prototype.buildHtmlDomList=function(a){var b=document.createElement("div");return b.innerHTML=a,b.children},a.prototype.swapTagToAd=function(a){var b,c=a.length;for(b=0;b<c;b++)this.el.parentNode.insertBefore(a[b].cloneNode(!0),this.el);this.el.parentNode.removeChild(this.el)},a}(),MTBADVS.InStream.AdController=function(){function a(a){if(!a||!a.adspot_id)throw new TypeError("adspot_id is required");this.adspot_id=a.adspot_id,this.loaded_ads=[],this.raw_res=null,this.placement_info={},this.request_sequence=0}function b(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].toObject().ad_id===b)return a[c]}var c=MTBADVS.Common.Util;return a.prototype.loadAds=function(a){var b=this;"undefined"==typeof a&&(a=function(){});var c=this.adspot_id,d=this.request_sequence;MTBADVS.InStream.Network.fetchInStreamAds(c,d,function(d,e,f){if(d)return void a(d);var g=new MTBADVS.InStream.PlacementInfoModel(f,c);b.loaded_ads=b.loaded_ads.concat(e),b.request_sequence++,b.placement_info=g,b.raw_res=f,a(null)})},a.prototype.notifyImp=function(a){if(!a||"0"==a||!parseInt(a,10)&&"string"!=typeof a)throw new TypeError("ad_id is required");var c=b(this.loaded_ads,a);if(!c)throw new TypeError("invalid ad id "+a);MTBADVS.InStream.Network.notifyImp(this.adspot_id,c),MTBADVS.InStream.Network.notifyTpImp(c)},a.prototype.getLoadedAds=function(){var a=c.map(this.loaded_ads,function(a){return a.toObjectWithPublicParams()});return a},a.prototype.getPlacementInfo=function(){return c.isFunction(this.placement_info.toObject)?this.placement_info.toObject():{}},a.prototype.getRawRes=function(){return this.raw_res},a.prototype.showAd=function(a,c){var d=b(this.loaded_ads,c);if(d){var e=d.toObjectWithPublicParams(),f=this.getPlacementInfo();a.show(e,f)}},a}(),MTBADVS.InStream.Default=function(){function a(){if(document.querySelectorAll)return document.querySelectorAll("[data-advs-adspot-id]");for(var a=[],b=document.body.getElementsByTagName("*"),c=b.length,d=0;d<c;d++)b[d].getAttribute("data-advs-adspot-id")&&a.push(b[d]);return a}function b(a){if(document.querySelectorAll)return document.querySelectorAll("[data-advs-adspot-id="+a+"]");for(var b=[],c=document.body.getElementsByTagName("*"),d=c.length,e=0;e<d;e++){var f=c[e].getAttribute("data-advs-adspot-id")||"";f===a&&b.push(c[e])}return b}function c(a){var c=b(a);j.forEach(c,function(a){a.removeAttribute("data-advs-adspot-id")})}function d(a,b){var c=k[b].rendered_index,d=k[b].controller,f=d.getLoadedAds(),g=f.slice(c),h={before_render:i._makeCallbackOfBeforeRender(),adspot_id:b},j=d.getPlacementInfo().template||e(b),l=i.options.force||{};if(l.template&&(j=e(b)),j){for(var m=new MTBADVS.InStream.Template(j),n=0;n<g.length&&n<a.length;n++){var o=g[n].ad_id,p=a[n],q=new MTBADVS.InStream.AdView(p,m,h);d.showAd(q,o),q.showed&&d.notifyImp(o)}k[b].rendered_index=f.length}}function e(a){var b,c,d=[];if(document.querySelectorAll)d=document.querySelectorAll('script[type="text/advs-instream-template"]');else{var e=document.getElementsByTagName("script");for(c=e.length,b=0;b<c;b++){var f=e[b].getAttribute("type")||"";"text/advs-instream-template"===f&&d.push(e[b])}}for(c=d.length,b=0;b<c;b++)if(d[b].getAttribute("data-adspot-id")===a)return d[b].innerHTML}function f(a){var b=k[a].controller,c=b.getRawRes();c&&MTBADVS.InStream.Network.callSyncURLs(c)}function g(a,b){return function(e){e||(d(a,b),c(b),f(b))}}function h(){var b,c,d,e=a(),f=[],h={};for(c=e.length,b=0;b<c;b++){var i=e[b];d=i.getAttribute("data-advs-adspot-id"),d&&(j.isArray(h[d])||(h[d]=[],f.push(d)),h[d].push(i))}for(c=f.length,b=0;b<c;b++){d=f[b];var l=h[d];k[d]={},k[d].rendered_index=0,k[d].controller=new MTBADVS.InStream.AdController({adspot_id:d}),k[d].controller.loadAds(g(l,d))}}var i={},j=MTBADVS.Common.Util,k={};i.options={};return i._makeCallbackOfBeforeRender=function(){if(j.isFunction(i.options.before_render))return i.options.before_render;var a={title_len:parseInt(i.options.title_length,10),desc_len:parseInt(i.options.description_length,10),advertiser_len:parseInt(i.options.displayed_advertiser_length,10),force:i.options.force||{}};return function(b,c){var d=c.title_length||a.title_len,e=c.description_length||a.desc_len,f=c.displayed_advertiser_length||a.advertiser_len;return a.force.title_length&&a.title_len&&(d=a.title_len),a.force.description_length&&a.desc_len&&(e=a.desc_len),a.force.displayed_advertiser_length&&a.advertiser_len&&(f=a.advertiser_len),(d||e||f)&&(f<11&&(f=11),d<b.title.length&&(b.title=b.title.substr(0,d-1)+"\u2026"),e<b.description.length&&(b.description=b.description.substr(0,e-1)+"\u2026"),f<b.displayed_advertiser.length&&(b.displayed_advertiser=b.displayed_advertiser.substr(0,f-1)+"\u2026")),b}},i.run=function(){j.isObject(arguments[0])&&(i.options=arguments[0]),i.options.immediately?h():j.waitDomReady(h)},i.reloadAds=function(){var a,c=0;for(a in k)if(k.hasOwnProperty(a)){var d=b(a);if(0===d.length)return;k[a].controller.loadAds(g(d,a)),c++}if(0===c)return void i.run()},i}()}();